version: '{build}'
branches:
  only:
  - master
skip_commits:
  files:
  - docs/*
  - assets/*
  - LICENSE
  - README.md
  - CODE_OF_CONDUCT.md
  - CONTRIBUTING.md
image: Visual Studio 2022
artifacts:
- path: build\artifacts\*.nupkg
- path: build\artifacts\*.snupkg
before_build:
- nuget restore
- choco install opencover.portable
- choco install codecov
build_script:
- ps: >-
          cd build

          .\build.ps1
test_script:
- OpenCover.Console.exe -register:user -target:"%xunit20%\xunit.console.x86.exe" -targetargs:"test" -filter:"+[Structr*]* -[Structr.Tests*]* -[Structr.Samples*]*" -output:".\coverage.xml"
- codecov -f "coverage.xml